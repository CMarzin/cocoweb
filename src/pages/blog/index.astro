---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';
import PostList from '../../components/PostList.astro';
import { useTranslations } from '../../i18n/utils';

const t = useTranslations('en');

// Try to get English content, fallback to French
let posts = await getCollection('blog', ({ id }) => id.startsWith('en/'));
const showTranslationNotice = posts.length === 0;

if (showTranslationNotice) {
  posts = await getCollection('blog', ({ id }) => id.startsWith('fr/'));
}
---

<BaseLayout 
  title="Tips - Cocoweb" 
  description="All tips and web discoveries on Cocoweb."
  lang="en"
>
  <div class="blog-page">
    <h1>Tips</h1>
    
    {showTranslationNotice && (
      <div class="translation-notice">
        {t('post.translation-notice')}
      </div>
    )}
    
    <p class="blog-description">
      My tech watch and web discoveries.
      {posts.length} articles published.
    </p>

    <PostList posts={posts} showTags={true} basePath="/blog" lang="en" />
  </div>
</BaseLayout>
